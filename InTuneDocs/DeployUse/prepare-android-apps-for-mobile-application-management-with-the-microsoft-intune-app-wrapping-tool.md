---
title: "Создание программы-оболочки для приложений Android с помощью соответствующего инструмента | Microsoft Intune"
description: "Здесь описано, как создать программу-оболочку для приложения Android без изменения кода самого приложения, а также подготовить приложения для применения политики управления мобильными приложениями."
keywords: 
author: karthikaraman
manager: arob98
ms.date: 07/06/2016
ms.topic: article
ms.prod: 
ms.service: microsoft-intune
ms.technology: 
ms.assetid: e9c349c8-51ae-4d73-b74a-6173728a520b
ms.reviewer: matgates
ms.suite: ems
translationtype: Human Translation
ms.sourcegitcommit: 2038ed6219a94dc4285891d71ce00fd51310f3e3
ms.openlocfilehash: 15d0877f799c89e2a8af65c416c0e914f898641f


---

# Подготовка приложений Android для управления мобильными приложениями с помощью инструмента упаковки для приложений Intune
**Инструмент упаковки для приложений Microsoft Intune (Microsoft Intune App Wrapping Tool) для Android** используется для изменения поведения внутрикорпоративных приложений Android с целью настройки возможностей приложения без изменения кода самого приложения.

Данный инструмент представляет собой программу командной строки Windows, которая выполняется в PowerShell и создает "оболочку" вокруг приложения. После обработки приложения его функциональность можно изменить с помощью настраиваемых [политик управления мобильными приложениями](configure-and-deploy-mobile-application-management-policies-in-the-microsoft-intune-console.md).

Если приложение использует библиотеку проверки подлинности Azure Active Directory (ADAL), необходимо выполнить действия в разделе [Создание программы-оболочки для приложений, использующих библиотеку Azure Active Directory (ADAL)](#how-to-wrap-apps-that-use-the-azure-active-directory-library) перед тем, как создать программу-оболочку приложения. Если вы не уверены, что приложение использует эту библиотеку, обратитесь к разработчику приложения.

Перед запуском инструмента просмотрите раздел [Вопросы безопасности при запуске инструмента упаковки для приложений](#security-considerations-for-running-the-app-wrapping-tool). Чтобы скачать этот инструмент, см. статью [Microsoft Intune App Wrapping Tool for Android](https://www.microsoft.com/download/details.aspx?id=47267) (Инструмент создания программ-оболочек для приложений Microsoft Intune для Android).

## Шаг 1. Выполнение необходимых условий для использования инструмента упаковки приложений

-   Инструмент упаковки для приложений необходимо запустить на компьютере под управлением Windows 7 или более поздней версии Windows.

-   Входное приложение должно представлять собой допустимый пакет приложения Android с расширением **APK** файла, а также:

    -   не может быть зашифровано;

    -   не должно быть упаковано с помощью инструмента упаковки для приложений;

    -   должно быть написано для Android 4.0 или более поздней версии.

-   Приложение должно быть разработано внутри вашей компании или по ее заказу. Этот инструмент нельзя использовать для обработки приложений, скачанных из магазина Google Play.

-   Чтобы запустить инструмент, необходимо установить последнюю версию [среды выполнения Java](http://java.com/download/) и убедиться, что для переменной пути Java в переменных среды Windows задано значение **C:\ProgramData\Oracle\Java\javapath**. Дополнительные сведения см. в [документации по Java](http://java.com/download/help/).

    > [!NOTE]
    > В некоторых случаях 32-разрядная версия Java может привести к проблемам с памятью. Рекомендуется установить 64-разрядную версию.

## Шаг 2. Установка инструмента упаковки приложений

1.  В Центре загрузки Майкрософт скачайте и откройте файл установки для инструмента упаковки для приложений на компьютере Windows.

2.  Примите условия лицензионного соглашения, а затем завершите установку.

Запомните папку, в которую был установлен инструмент. По умолчанию используется расположение **C:\Program Files (x86)\Microsoft Intune Mobile Application Management\Android\App Wrapping Tool**.

## Шаг 3. Запуск инструмента упаковки приложений

1.  На компьютере Windows, где установлен инструмент создания программ-оболочек для приложений, откройте окно PowerShell от имени администратора.

2.  Из папки, куда был установлен инструмент, импортируйте модуль PowerShell инструмента упаковки для приложений:

    ```
    Import-Module .\IntuneAppWrappingTool.psm1
    ```

3.  Запустите инструмент с помощью команды **invoke-AppWrappingTool**, указав следующие параметры. Параметры, помеченные как "необязательные", предназначены для приложений, которые используют библиотеку Azure Active Directory (ADAL). Дополнительные сведения см. в разделе [Создание программы-оболочки для приложений, использующих библиотеку Azure Active Directory (ADAL)](#how-to-wrap-apps-that-use-the-azure-active-directory-library).

|Параметр|Дополнительные сведения|Примеры|
|-------------|--------------------|---------|
|**-InputPath**&lt;строка&gt;|Путь исходного приложения Android (APK).| |
|**-OutputPath**&lt;строка&gt;|Путь к "выходному" приложению Android. Если это тот же путь к каталогу, что и InputPath, произойдет сбой упаковки.| |
|**-KeyStorePath**&lt;строка&gt;|Путь к KEYSTORE-файлу, который содержит пару открытого и закрытого ключей для подписания.| |
|**-KeyStorePassword**&lt;SecureString&gt;|Пароль, используемый для расшифровки KEYSTORE-файла. Для Android требуется, чтобы все пакеты приложения (с расширением APK) были подписаны. Используйте Java Keytool для создания пароля хранилища ключей, как показано в примере. См. дополнительные сведения в разделе [KeyStore](https://docs.oracle.com/javase/7/docs/api/java/security/KeyStore.html).|keytool.exe -genkey -v -keystore keystorefile -alias ks -keyalg RSA -keysize 2048 -validity 50000 |
|**-KeyAlias**&lt;строка&gt;|Имя ключа, используемого для подписания.| |
|**-KeyPassword**&lt;SecureString&gt;|Пароль, используемый для расшифровки закрытого ключа, который будет использоваться для подписания.| |
|**-SigAlg**&lt;SecureString&gt;|Имя алгоритма подписи, используемого для подписи. Этот алгоритм должен быть совместим с закрытым ключом.|Примеры: SHA256withRSA, SHA1withRSA, MD5withRSA|
|**-ClientID**&lt;GUID&gt;|Идентификатор клиента Azure Active Directory входного приложения (необязательно).| |
|**-AuthorityURI**&lt;URI&gt;|URI центра Azure Active Directory Authority входного приложения (необязательно).| |
|**-SkipBroker**&lt;логическое значение&gt;|Указывает, поддерживает ли входное приложение единый вход через посредника на устройства (необязательно). |Значение **true**, если входное приложение не поддерживает единый вход через посредника на устройство. Используйте параметр NonBrokerRedirectURI. Значение **false**, если входное приложение поддерживает единый вход через посредника на устройства|
|**-NonBrokerRedirectURI**&lt;URI&gt;|URI перенаправления Azure Active Directory, который используется, если значение SkipBroker равно true (необязательно).|  |


**&lt;CommonParameters&gt;**
 (поддерживает общие параметры PowerShell, например verbose, debug и т. п. (необязательно)).

- Список общих параметров см. в разделе [Центр скриптов Майкрософт](https://technet.microsoft.com/library/hh847884.aspx).

- Для просмотра справки по инструменту введите команду:

    ```
    Help Invoke-AppWrappingTool
    ```
- Дополнительные сведения об интеграции Azure Active Directory (AAD) см. в подразделе [Создание программы-оболочки для приложений, использующих библиотеку Azure Active Directory (ADAL)](#how-to-wrap-apps-that-use-the-azure-active-directory-library).

**Пример.**


    Import-Module "C:\Program Files (x86)\Microsoft Intune Mobile Application Management\Android\App Wrapping Tool\IntuneAppWrappingTool.psm1"
    invoke-AppWrappingTool -InputPath .\app\HelloWorld.apk -OutputPath .\app.wrapped\HelloWorld_wrapped2.apk -KeyStorePath "C:\Program Files (x86)\Java\jre1.8.0_91\bin\keystorefile" -keyAlias ks -SigAlg SHA1withRSA -Verbose

Затем появится запрос на **KeyStorePassword** и **KeyPassword**.

Упакованное приложение создается и сохраняется вместе с файлом журнала по указанному выходному пути.

## Вопросы безопасности при запуске инструмента упаковки для приложений 
Во избежание потенциального спуфинга, раскрытия информации и атак с несанкционированным повышением привилегий:

-   Убедитесь, что входное бизнес-приложение, выходное приложение и Java KeyStore находятся на том же компьютере, где запущен инструмент упаковки для приложений.

-   Импортируйте выходное приложение в консоль Intune на том же компьютере, где запущен инструмент. Дополнительные сведения о Java Keytool см. в разделе [keytool](https://docs.oracle.com/javase/8/docs/technotes/tools/unix/keytool.html).

-   Если выходное приложение и инструмент расположены по UNC-пути и вы не используете инструмент и входные файлы на одном и том же компьютере, настройте среду на безопасную работу с помощью [протокола IPsec](http://en.wikipedia.org/wiki/IPsec) или [подписывания SMB](https://support.microsoft.com/en-us/kb/887429).

-   Убедитесь, что приложение поступает из надежного источника, особенно при использовании Azure Active Directory (AAD), который может разрешить приложению доступ к токену AAD во время выполнения.

-   Обеспечьте безопасность выходного каталога, содержащего упакованное приложение. Рассмотрите возможность использования каталога уровня пользователя в качестве выходного каталога.

## Создание программы-оболочки для приложений, использующих библиотеку Azure Active Directory (ADAL)
Если приложение использует библиотеку проверки подлинности Azure Active Directory (ADAL), необходимо выполнить следующие действия перед тем, как создать программу-оболочку приложения.

### Шаг 1. Проверка выполнения требований к ADAL
Для приложений, использующих ADAL, должны выполняться следующие условия.

-   Приложение должно использовать ADAL версии 1.0.2 или более поздней.

-   Разработчик должен предоставить своему приложению доступ к ресурсу управления мобильными приложениями Intune, как описано в подразделе [Шаг 3. Настройка доступа к управлению мобильными устройствами в AAD](#step-3-configure-access-to-mobile-app-management-in-aad).

### Шаг 2. Просмотр идентификаторов, которые необходимо получить при регистрации приложения
На следующем шаге вы используете портал управления Azure для регистрации приложений (которые используют ADAL с Azure Active Directory (AAD)) для получения уникальных идентификаторов, перечисленных в следующей таблице. Затем вы передадите идентификаторы разработчику при интеграции ADAL с приложением.

|Идентификатор|Дополнительные сведения|Значение по умолчанию|
|--------------|--------------------|-----------------|
|**Идентификатор клиента**|Уникальный идентификатор GUID, который создается для приложения после его регистрации в AAD.<br /><br />Если вы знаете идентификатор клиента приложения, укажите это значение. В противном случае используйте значение по умолчанию.|6c7e8096-f593-4d72-807f-a5f86dcc9c77|
|**URI центра**|Значение URI центра для объектов AAD (например, пользователей и групп).<br /><br />Параметр AuthorityURI является необязательным для инструмента создания программы-оболочки для приложения. Если вы не используете параметр, применяется URI по умолчанию.||
|**SkipBroker**|Значение, указывающее, будет ли использоваться посредник на портале компании.<br /><br />Значение **true** — корпоративный портал не будет использоваться для проверки подлинности ADAL.<br /><br />Значение **false** — корпоративный портал будет использоваться для проверки подлинности ADAL. Портал компании использует зарегистрированного пользователя для единого входа.||
|**URI перенаправления без посредника**|URI входа, который используется, если ADAL не применяет приложение посредника (портал компании Intune).|urn:ietf:wg:oauth:2.0:oob|
|**Идентификатор ресурса**|Указатель на ресурсы AAD приложения.||

### Шаг 3. Настройка доступа к управлению мобильными приложениями в AAD
Прежде чем использовать значения регистрации AAD приложения в средстве создания программы-оболочки для приложений, разработчик приложений должен предоставить этому приложению доступ к ресурсу управления мобильными приложениями Intune, выполнив следующие действия.

1.  Войдите в существующую учетную запись AAD на портале управления Azure.

2.  Выберите **регистрацию имеющегося бизнес-приложения**.

3.  В разделе **настройка** выберите **Настройка доступа к веб-API в других приложениях**.

4.  В первом раскрывающемся списке в разделе **Permission to other applications** (Разрешение для других приложений) выберите **Управление мобильными приложениями Intune**.

Теперь вы можете использовать идентификатор клиента приложения в инструменте создания программы-оболочки приложения. Идентификатор клиента можно найти на портале управления Azure Active Directory, как описано в таблице подраздела [Шаг 2. Просмотр идентификаторов, которые необходимо получить при регистрации приложения](#step-2-review-the-identifiers-you-need-to-get-when-you-register-the-app).

### Шаг 4. Использование значений идентификатора AAD в инструменте упаковки приложений
С помощью значений идентификатора, полученных в процессе регистрации, введите значения в качестве свойств командной строки в инструменте программы-оболочки приложения. Необходимо указать все значения в таблице, чтобы конечные пользователи успешно выполнили проверку подлинности приложения. Если значение не указано, используется значение по умолчанию.

|Идентификатор|Параметр|
|--------------|-------------|
|Идентификатор клиента|ClientID|
|URI центра|Authority-URI|
|SkipBroker|SkipBroker|
|URI перенаправления без посредника|NonBrokerRedirectURI|
|Идентификатор ресурса|ResourceID|
Учитывайте следующие моменты при создании программы-оболочки приложения.

-   Чтобы убедиться, что аутентификация успешно пройдена, [!INCLUDE[wit_nextref](../includes/wit_nextref_md.md)] получает маркер AAD, связанный с идентификатором ресурса MAM. Однако токен не используется в каком-либо вызове, который в свою очередь проверит допустимость токена. [!INCLUDE[wit_nextref](../includes/wit_nextref_md.md)] только читает имя субъекта-пользователя (UPN) выполнившего вход пользователя для определения доступа к приложению. Маркер AAD не используется для дальнейших вызовов службы.

-   Указание идентификатора клиента приложения и URI центра позволяет избежать дублирования запросов на ввод учетных данных для входа. Необходимо зарегистрировать идентификатор клиента для доступа к опубликованному ресурсу MAM [!INCLUDE[wit_nextref](../includes/wit_nextref_md.md)] на панели мониторинга AAD. Если вы не зарегистрируете идентификатор клиента, у пользователей произойдет сбой при запуске приложения.


### См. также
- [Выбор подготовки приложений для управления мобильными приложениями с помощью Microsoft Intune](decide-how-to-prepare-apps-for-mobile-application-management-with-microsoft-intune.md)

- [Подготовка приложений для управления мобильными приложениями с помощью пакета SDK](use-the-sdk-to-enable-apps-for-mobile-application-management.md)



<!--HONumber=Jul16_HO4-->


